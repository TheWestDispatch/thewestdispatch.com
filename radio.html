<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The West Dispatch Radio</title>
    
    <!-- Tailwind CSS CDN für schnelles, responsives Styling --><script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Font: Lato (Neutral, sauber, weniger rund) --><link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome für Icons (Social Media Logos) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* CSS für das Styling */
        body {
            /* Schriftart auf Lato gesetzt */
            font-family: 'Lato', sans-serif; 
            /* Hintergrundbild: Pfad wurde übernommen. */
            background-image: url('Images/west dispatch cover background.png');
            background-size: cover; /* Bild deckt den gesamten Hintergrund ab */
            background-position: center; /* Bild zentrieren */
            background-attachment: fixed; /* Bild bleibt beim Scrollen fixiert */
            color: #e2e8f0;
            min-height: 100vh;
        }
        /* Stellt sicher, dass das iFrame sich an den Container anpasst */
        .mixcloud-embed-container {
            width: 100%;
            /* Höhe des Mixcloud-Players */
            max-height: 120px; 
            margin-bottom: 24px;
        }
        iframe {
            /* Ecken des iFrame wurden auf 8px belassen, für einen eingebetteten Player ist das oft erwünscht */
            border-radius: 8px; 
        }
        /* Optional: Eine leichte Überlagerung, um den Text besser lesbar zu machen */
        .overlay {
            background-color: rgba(0, 0, 0, 0.5); /* Dunkle, halbtransparente Überlagerung */
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1; /* Hinter dem Inhalt */
        }
        /* CSS für das Kopieren-Icon, um sicherzustellen, dass es klickbar ist */
        .copy-button {
            cursor: pointer;
            flex-shrink: 0; /* Verhindert, dass der Button schrumpft */
            margin-left: 1rem;
        }

        /* Styling für die Lautstärkeslider (Skeuomorph, optional) */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #4A90E2; /* Blauer Track */
            border-radius: 4px;
            cursor: default;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.4);
            cursor: default;
        }
        
    </style>
</head>

<body class="flex flex-col items-center p-4 py-10 relative">
    <!-- Funktion zum Kopieren in die Zwischenablage -->
    <script>
        // Funktion zum Kopieren von Text in die Zwischenablage
        function copyToClipboard(text, buttonElement) {
            try {
                // Führt den Kopierbefehl aus
                const tempInput = document.createElement('textarea');
                tempInput.value = text;
                document.body.appendChild(tempInput);
                tempInput.select();
                // document.execCommand('copy') ist notwendig, da navigator.clipboard im iFrame eingeschränkt sein kann
                document.execCommand('copy'); 
                document.body.removeChild(tempInput);

                // Bestätigungsmeldung anzeigen (anstelle von alert)
                showCopyMessage(buttonElement);
            } catch (err) {
                console.error('Fehler beim Kopieren:', err);
            }
        }

        // Funktion zur Anzeige einer kurzen "Kopiert!"-Meldung neben dem Button
        function showCopyMessage(buttonElement) {
            const message = document.createElement('span');
            message.textContent = "Kopiert!";
            message.className = 'text-xs text-green-400 absolute transition-opacity duration-700 opacity-100';
            
            // Positionierung relativ zum Button (rechts)
            const rect = buttonElement.getBoundingClientRect();
            message.style.top = `${rect.top}px`;
            message.style.left = `${rect.right + 5}px`;
            
            document.body.appendChild(message);

            // Meldung nach 1 Sekunde ausblenden und entfernen
            setTimeout(() => {
                message.style.opacity = '0';
                message.style.transition = 'opacity 0.7s';
                setTimeout(() => {
                    message.remove();
                }, 700);
            }, 1000);
        }

        // NEUE FUNKTIONALITÄT: Lädt die Tracks aus der Textdatei und erstellt die Liste
        async function loadTracklist() {
            const container = document.getElementById('tracklist-container');
            if (!container) return;

            try {
                // Versucht, die Tracklist-Datei zu laden
                const response = await fetch('tracklist.txt');
                if (!response.ok) {
                    throw new Error(`Konnte tracklist.txt nicht laden: ${response.statusText}`);
                }
                const text = await response.text();
                
                // Text in einzelne Zeilen (Tracks) aufteilen
                const tracks = text.split('\n').filter(line => line.trim() !== '');
                
                let htmlContent = '';
                
                tracks.forEach((trackLine, index) => {
                    // Extrahieren des Titels (alles nach der ersten Nummer und Punkt), um es zu kopieren
                    const match = trackLine.match(/^(\d+\.|\d+\.\s)?(.+)/);
                    const trackToCopy = match ? match[2].trim().replace(/\s\(\d+:\d+\)$/, '') : trackLine.trim(); // Entfernt Zeitangabe beim Kopieren

                    // Bestimmt die Klasse für die Trennlinie
                    const isLast = index === tracks.length - 1;
                    const borderClass = isLast ? '' : 'border-b border-gray-600 pb-1';

                    // Generiert das HTML für den Listeneintrag
                    htmlContent += `
                        <li class="flex justify-between items-center ${borderClass}">
                            <span data-track-full="${trackLine}" class="truncate">${trackLine}</span>
                            <button 
                                onclick="copyToClipboard(this.getAttribute('data-track'), this)"
                                data-track="${trackToCopy}"
                                class="copy-button text-[#80ffd7] hover:text-white transition duration-200 text-base"
                                aria-label="Titel kopieren">
                                <i class="far fa-copy"></i>
                            </button>
                        </li>
                    `;
                });
                
                container.innerHTML = htmlContent;

            } catch (error) {
                console.error("Fehler beim Laden der Tracklist:", error);
                container.innerHTML = `<li class="text-red-400">Tracklist konnte nicht geladen werden.</li>`;
            }
        }
        
        // Initialisierungsfunktion, die beim Laden des Fensters ausgeführt wird
        window.onload = function() {
            // Media Session API für Lockscreen-Anzeige
            if ('mediaSession' in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: "The West Dispatch Radio", 
                    artist: "Ausgabe 23 - 23.11.25", 
                    album: 'Mixcloud Stream',
                    artwork: [
                        { src: 'Images/week21.jpg', sizes: '512x512', type: 'image/jpeg' } 
                    ]
                });

                navigator.mediaSession.setActionHandler('play', () => {
                    console.log('Media Session: Play pressed');
                });
                navigator.mediaSession.setActionHandler('pause', () => {
                    console.log('Media Session: Pause pressed');
                });
                
                navigator.mediaSession.playbackState = 'playing'; 
            }
            
            // Lädt die Tracks dynamisch
            loadTracklist();
        }
    </script>
    
    <!-- Überlagerung für bessere Lesbarkeit --><div class="overlay"></div>

    <!-- 0. CONTAINER: LEERE KOPFZEILE (Grau) - Spitze Ecken und Schatten -->
    <div class="max-w-xl w-full bg-gray-700 bg-opacity-90 h-10 relative z-10 mb-4 shadow-xl">
        <!-- Dieser Container ist nur für die visuelle Trennung und bleibt leer -->
    </div>

    <!-- 1. CONTAINER: Social Media Links (Header-Leiste) - Spitze Ecken und Schatten -->
    <div class="max-w-xl w-full bg-[#424242] bg-opacity-90 p-3 relative z-10 mb-4 shadow-xl">
        <div class="flex justify-between items-center">
            <!-- Text links in #ffa45e -->
            <span class="text-[#ffa45e] font-bold text-lg tracking-widest">THE WEST DISPATCH</span>
            
            <!-- Icons rechts -->
            <div class="flex space-x-6 text-[#80ffd7]">
                <!-- YouTube -->
                <a href="#" target="_blank" aria-label="YouTube" class="text-2xl hover:text-white transition duration-200">
                    <i class="fab fa-youtube"></i>
                </a>
                <!-- Instagram -->
                <a href="#" target="_blank" aria-label="Instagram" class="text-2xl hover:text-white transition duration-200">
                    <i class="fab fa-instagram"></i>
                </a>
                <!-- TikTok -->
                <a href="#" target="_blank" aria-label="TikTok" class="text-2xl hover:text-white transition duration-200">
                    <i class="fab fa-tiktok"></i>
                </a>
                <!-- Facebook -->
                <a href="#" target="_blank" aria-label="Facebook" class="text-2xl hover:text-white transition duration-200">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <!-- Mixcloud -->
                <a href="#" target="_blank" aria-label="Mixcloud" class="text-2xl hover:text-white transition duration-200">
                    <i class="fab fa-mixcloud"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- 2. CONTAINER: Hauptcontainer (Player und Infos) - Spitze Ecken und Schatten -->
    <div class="max-w-xl w-full bg-[#424242] bg-opacity-90 p-8 relative z-10 shadow-xl">
        
        <!-- NEU: Wrapper für quadratisches (1:1) Seitenverhältnis des Bildes -->
        <div class="w-full aspect-square relative mb-4">
            <!-- Cover Bild: Pfad auf "Images/week21.jpg" geändert -->
            <img src="Images/week21.jpg" alt="Cover Bild" class="absolute inset-0 w-full h-full object-cover">
        </div>
        
        <!-- Überschrift mit Farbe #80ffd7 -->
        <h1 class="text-3xl font-bold mb-4 text-[#80ffd7] text-center uppercase">The West Dispatch Radio</h1>
        
        <!-- Text unter der Überschrift -->
        <p class="text-white text-lg mb-6 text-center">Ausgabe 23 - 23.11.25</p>
        
        <!-- Mixcloud Player mit dem gewünschten Stream -->
        <div class="mixcloud-embed-container">
            <iframe 
                width="100%" 
                height="120" 
                src="https://player-widget.mixcloud.com/widget/iframe/?hide_cover=1&light=1&feed=%2FNTSRadio%2Fthe-great-african-disco-w-temi-kogbe-80s-jams-9th-november-2025%2F" 
                frameborder="0"
                allowfullscreen>
            </iframe>
        </div>

    </div>

    <!-- 3. CONTAINER: Tracklist - Spitze Ecken und Schatten -->
    <div class="max-w-xl w-full bg-[#424242] bg-opacity-90 p-8 relative z-10 mt-4 shadow-xl">
        
        <h2 class="text-xl font-bold mb-4 text-[#80ffd7] text-center uppercase">Tracklist</h2>
        
        <!-- Tracklist Container: Jetzt leer. Die Tracks werden per JavaScript aus tracklist.txt geladen. -->
        <ul id="tracklist-container" class="text-white text-sm space-y-3 list-none p-0">
            <!-- Tracks werden hier dynamisch eingefügt -->
        </ul>
        
    </div>

    <!-- 4. BUTTON: Mehr Dispatch (ohne Box) -->
    <div class="max-w-xl w-full mt-4 flex justify-center z-10">
        <!-- Button mit Akzentfarbe #ffa45e, spitzen Ecken und öffnet Link im neuen Tab -->
        <a href="index.html" target="_blank" class="bg-[#ffa45e] text-black font-bold py-3 px-6 shadow-md hover:bg-[#ffc196] transition duration-200 uppercase text-sm tracking-wide">
            Noch mehr The West Dispatch
        </a>
    </div>

</body>
</html>
